# 独占设备的分配与回收

## 数据结构

操作系统设备“设备分配表”，用来记录计算机系统所配置的独占设备类型、台数以及分配情况。 设备分配表可由“设备类表”和“设备表”两部分组成，在设备类表中，每类设备对应一行，内容通常包括设备类、总台数、空闲台数和设备表起始地址。
设备表中，每台设备对应一行，包括设备物理名、设备逻辑名、占用设备的进程号、是否分配等。在设备表中，同类设备登记在连续的行中。

设备类表:

| 设备类 | 总台数 | 空闲台数 | 设备表地址 |
|-----|-----|------|-------|
| 输入机 | 2   | 1    |       |
|     | 3   | 2    |       |

设备表:

| 设备物理名 | 是否分配  | 占用进程  | 相对号  |
|-------|-------|-------|------|
| 001   | 已分配   | P1    |      | 
| 002   | 未分配   |       |      |
| 003   | 未分配   |       |      |
| 004   | 已分配   | P2    |      |

## 设备分配

1. 当进程申请某类设备时，系统先查“设备类表”。
2. 如果该类设备的现存台数可以满足申请要求，则从该类设备的“设备表”始地址开始依次查该设备在设备表中的登记项，找出“未分配”的设备分配给进程。
   3.分配后要修改设备类表中的现存台数，把分配给进程的设备标志改为“已分配”且填上占用设备的进程名。
3. 然后把设备的绝对号与相对号的对应关系通知用户，以便用户在分配到的设备上装上存储介质。

## 设备回收

当进程执行结束撤离时应归还独占的设备，系统根据进程名查设备表，找出进程占用设备的登记栏，把标志修改成“未分配”，清除进程名。 同时把回收的设备台数加到设备类表中的空闲台数中。
